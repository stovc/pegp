Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 140, in <module>
    data = pd.read_csv(data_path, index_col=0)  # dataframe with blastp results
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/util/_decorators.py", line 211, in wrapper
    return func(*args, **kwargs)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/util/_decorators.py", line 331, in wrapper
    return func(*args, **kwargs)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 950, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 605, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1442, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1735, in _make_engine
    self.handles = get_handle(
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/common.py", line 856, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: 'projects/Clp_R_dom/hits_df.csv'
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 140, in <module>
    data = pd.read_csv(data_path, index_col=0)  # dataframe with blastp results
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/util/_decorators.py", line 211, in wrapper
    return func(*args, **kwargs)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/util/_decorators.py", line 331, in wrapper
    return func(*args, **kwargs)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 950, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 605, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1442, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1735, in _make_engine
    self.handles = get_handle(
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/io/common.py", line 856, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: 'projects/Clp_R_dom/hits_df.csv'
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'length'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 187, in <module>
    zs = list(df_handle['length'])
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'length'
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'length'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 188, in <module>
    zs = list(df_handle['length'])
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'length'
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'length'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 187, in <module>
    zs = list(df_handle['length'])
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'length'
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'length'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 187, in <module>
    zs = list(df_handle['length'])
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'length'
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'length'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 189, in <module>
    zs = list(df_handle['length'])
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'length'
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'length'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 189, in <module>
    zs = list(df_handle['length'])
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'length'
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 214, in <module>
    with open(fastq_file_path) as file:
NameError: name 'fastq_file_path' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 225, in <module>
    with open(fastq_file_path) as file:
NameError: name 'fastq_file_path' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 225, in <module>
    with open(fastq_file_path) as file:
NameError: name 'fastq_file_path' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 235, in <module>
    txt = f"Homology search using: {hmmer_result.program} {hmmer_result.version}"
NameError: name 'hmmer_result' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 238, in <module>
    txt = f"Homology search using: {hmmer_result.program} {hmmer_result.version}"
NameError: name 'hmmer_result' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 241, in <module>
    txt = f"Homology search using: {hmmer_result.program} {hmmer_result.version}"
NameError: name 'hmmer_result' is not defined
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'ID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 245, in <module>
    number_of_HSPs = len(data['ID'])
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'ID'
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'ID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 241, in <module>
    number_of_HSPs = len(data['ID'])
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'ID'
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'ID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 241, in <module>
    number_of_HSPs = len(data['ID'])
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'ID'
Traceback (most recent call last):
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3803, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'ID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 241, in <module>
    ids = data['ID']
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/frame.py", line 3805, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    raise KeyError(key) from err
KeyError: 'ID'
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 246, in <module>
    number_of_HSPs = len(ids)
NameError: name 'ids' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/03_plot_search.py", line 247, in <module>
    number_of_HSPs = len(ids)
NameError: name 'ids' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/04_filter.py", line 55, in <module>
    df['filtered'] = [df.query_coverage > coverage_threshold and
  File "/Bmo/aberdichevskaya/pegp/scripts/04_filter.py", line 55, in <listcomp>
    df['filtered'] = [df.query_coverage > coverage_threshold and
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/generic.py", line 1527, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/04_filter.py", line 56, in <module>
    df['filtered'] = [df.query_coverage > coverage_threshold and
  File "/Bmo/aberdichevskaya/pegp/scripts/04_filter.py", line 56, in <listcomp>
    df['filtered'] = [df.query_coverage > coverage_threshold and
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/generic.py", line 1527, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 183, in <module>
    clustered_ids.append(seq_record.id)
AttributeError: 'set' object has no attribute 'append'
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 183, in <module>
    clustered_ids.append(seq_record.id)
AttributeError: 'set' object has no attribute 'append'
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 191, in <module>
    elif not df.index[i] in clustered_ids:
NameError: name 'df' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 210, in <module>
    plot_3d(data_points, data, color_axis='status', color_dict=status_color_dict)
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 45, in plot_3d
    labels = [value for value in list(df_handle[color_axis])]
NameError: name 'df_handle' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 210, in <module>
    plot_3d(data_points, data, color_axis='status', color_dict=status_color_dict)
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 53, in plot_3d
    legend_elements = [Line2D([0], [0], marker='o', color='w',
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 53, in <listcomp>
    legend_elements = [Line2D([0], [0], marker='o', color='w',
NameError: name 'Line2D' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 211, in <module>
    plot_3d(data_points, data, color_axis='status', color_dict=status_color_dict)
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 78, in plot_3d
    ax.set_xlim(None, ident_lim)
NameError: name 'ident_lim' is not defined
Traceback (most recent call last):
  File "/Bmo/aberdichevskaya/pegp/scripts/08_plot_filtering_clustering.py", line 169, in <module>
    genome_consistency_output_hits_cnt = len(data[data.filtered_clustered == True].index)
  File "/home/aberdichevskaya/anaconda3/envs/pegp/lib/python3.9/site-packages/pandas/core/generic.py", line 5902, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'filtered_clustered'
